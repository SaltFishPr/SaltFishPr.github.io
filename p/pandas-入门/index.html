<!doctype html><html lang=en-us>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Kaggle —— Pandas 入门"><title>Pandas 入门</title>
<link rel=canonical href=https://saltfishpr.github.io/p/pandas-%E5%85%A5%E9%97%A8/>
<link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="Pandas 入门">
<meta property="og:description" content="Kaggle —— Pandas 入门">
<meta property="og:url" content="https://saltfishpr.github.io/p/pandas-%E5%85%A5%E9%97%A8/">
<meta property="og:site_name" content="咸鱼硕的博客">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="data science"><meta property="article:published_time" content="2020-05-25T00:00:00+08:00"><meta property="article:modified_time" content="2020-05-25T00:00:00+08:00">
<meta name=twitter:site content="@saltfishpr">
<meta name=twitter:creator content="@saltfishpr"><meta name=twitter:title content="Pandas 入门">
<meta name=twitter:description content="Kaggle —— Pandas 入门">
<link rel="shortcut icon" href=https://go.dev/favicon.ico>
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>Back</span>
</a>
</div>
<main class="main full-width">
<article class=main-article>
<header class=article-header>
<div class=article-details>
<header class=article-category>
<a href=/categories/python/>
python
</a>
</header>
<h2 class=article-title>
<a href=/p/pandas-%E5%85%A5%E9%97%A8/>Pandas 入门</a>
</h2>
<h3 class=article-subtitle>
Kaggle —— Pandas 入门
</h3>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>May 25, 2020</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
8 minute read
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<h1 id=kaggle-pandas-入门>Kaggle Pandas 入门</h1>
<p>读取数据集</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> pandas <span style=color:#66d9ef>as</span> pd
reviews <span style=color:#f92672>=</span> pd<span style=color:#f92672>.</span>read_csv(<span style=color:#e6db74>&#34;~/Programming/datasets/winemag-data-130k-v2.csv&#34;</span>)
</code></pre></div><h2 id=分组和排序>分组和排序</h2>
<p>对分数分组求和</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#34;points&#34;</span>)<span style=color:#f92672>.</span>points<span style=color:#f92672>.</span>count()
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>points
80       397
81       692
82      1836
...
98        77
99        33
100       19
Name: points, dtype: int64
</code></pre><p>获得相同评分葡萄酒的最低价格</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#34;points&#34;</span>)<span style=color:#f92672>.</span>price<span style=color:#f92672>.</span>min()
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>points
80      5.0
81      5.0
82      4.0
...
98     50.0
99     44.0
100    80.0
Name: price, dtype: float64
</code></pre><p>从每个酒庄中选择第一瓶葡萄酒的名称</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>groupby(<span style=color:#e6db74>&#39;winery&#39;</span>)<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> df: df<span style=color:#f92672>.</span>title<span style=color:#f92672>.</span>iloc[<span style=color:#ae81ff>0</span>])
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>winery
1+1=3                                     1+1=3 NV Rosé Sparkling (Cava)
10 Knots                            10 Knots 2010 Viognier (Paso Robles)
100 Percent Wine              100 Percent Wine 2015 Moscato (California)
1000 Stories           1000 Stories 2013 Bourbon Barrel Aged Zinfande...
1070 Green                  1070 Green 2011 Sauvignon Blanc (Rutherford)
...
Órale                       Órale 2011 Cabronita Red (Santa Ynez Valley)
Öko                    Öko 2013 Made With Organically Grown Grapes Ma...
Ökonomierat Rebholz    Ökonomierat Rebholz 2007 Von Rotliegenden Spät...
àMaurice               àMaurice 2013 Fred Estate Syrah (Walla Walla V...
Štoka                                    Štoka 2009 Izbrani Teran (Kras)
Length: 16757, dtype: object
</code></pre><p>根据国家和省份挑选最好的葡萄酒</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>groupby([<span style=color:#e6db74>&#34;country&#34;</span>, <span style=color:#e6db74>&#34;province&#34;</span>])<span style=color:#f92672>.</span>apply(<span style=color:#66d9ef>lambda</span> df:df<span style=color:#f92672>.</span>loc[df<span style=color:#f92672>.</span>points<span style=color:#f92672>.</span>idxmax()])
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>                            Unnamed: 0  ...                winery
country   province                      ...
Argentina Mendoza Province       82754  ...  Bodega Catena Zapata
          Other                  78303  ...                Colomé
Armenia   Armenia                66146  ...              Van Ardi
Australia Australia Other        37882  ...       Marquis Philips
          New South Wales        85337  ...            De Bortoli
                                ...  ...                   ...
Uruguay   Juanico                 9133  ...        Familia Deicas
          Montevideo             15750  ...                 Bouza
          Progreso               93103  ...                Pisano
          San Jose               39898  ...        Castillo Viejo
          Uruguay                39361  ...               Narbona
[425 rows x 14 columns]
</code></pre><p><code>agg()</code> 方法可以在一个 dataframe 上运行一些一维的函数</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>groupby([<span style=color:#e6db74>&#39;country&#39;</span>])<span style=color:#f92672>.</span>price<span style=color:#f92672>.</span>agg([len, min, max])
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>                            len   min     max
country
Argentina                3800.0   4.0   230.0
Armenia                     2.0  14.0    15.0
Australia                2329.0   5.0   850.0
...
US                      54504.0   4.0  2013.0
Ukraine                    14.0   6.0    13.0
Uruguay                   109.0  10.0   130.0
</code></pre><p>多索引：</p>
<p>使用 <code>groupby()</code> 可能会产生多索引</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>countries_reviewed <span style=color:#f92672>=</span> reviews<span style=color:#f92672>.</span>groupby([<span style=color:#e6db74>&#39;country&#39;</span>, <span style=color:#e6db74>&#39;province&#39;</span>])<span style=color:#f92672>.</span>description<span style=color:#f92672>.</span>agg([len])
countries_reviewed
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>                             len
country   province
Argentina Mendoza Province  3264
          Other              536
Armenia   Armenia              2
Australia Australia Other    245
          New South Wales     85
                          ...
Uruguay   Juanico             12
          Montevideo          11
          Progreso            11
          San Jose             3
          Uruguay             24
[425 rows x 1 columns]
</code></pre><p>多索引转回常规索引</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>countries_reviewed<span style=color:#f92672>.</span>reset_index()
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>       country          province   len
0    Argentina  Mendoza Province  3264
1    Argentina             Other   536
2      Armenia           Armenia     2
3    Australia   Australia Other   245
4    Australia   New South Wales    85
..         ...               ...   ...
420    Uruguay           Juanico    12
421    Uruguay        Montevideo    11
422    Uruguay          Progreso    11
423    Uruguay          San Jose     3
424    Uruguay           Uruguay    24
[425 rows x 3 columns]
</code></pre><p>使用 <code>sort_values()</code> 对数据排序（默认为升序排序）</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>countries_reviewed <span style=color:#f92672>=</span> countries_reviewed<span style=color:#f92672>.</span>reset_index()
countries_reviewed<span style=color:#f92672>.</span>sort_values(by<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;len&#39;</span>)
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>          country               province    len
179        Greece  Muscat of Kefallonian      1
192        Greece          Sterea Ellada      1
194        Greece                 Thraki      1
354  South Africa             Paardeberg      1
40         Brazil       Serra do Sudeste      1
..            ...                    ...    ...
409            US                 Oregon   5373
227         Italy                Tuscany   5897
118        France               Bordeaux   5941
415            US             Washington   8639
392            US             California  36247
[425 rows x 3 columns]
</code></pre><p>降序排序</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>countries_reviewed<span style=color:#f92672>.</span>sort_values(by<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;len&#39;</span>, ascending<span style=color:#f92672>=</span><span style=color:#66d9ef>False</span>)
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>          country         province    len
392            US       California  36247
415            US       Washington   8639
118        France         Bordeaux   5941
227         Italy          Tuscany   5897
409            US           Oregon   5373
..            ...              ...    ...
101       Croatia              Krk      1
247   New Zealand        Gladstone      1
357  South Africa  Piekenierskloof      1
63          Chile          Coelemu      1
149        Greece           Beotia      1
[425 rows x 3 columns]
</code></pre><p>重新按照索引排序</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>countries_reviewed<span style=color:#f92672>.</span>sort_index()
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>       country          province   len
0    Argentina  Mendoza Province  3264
1    Argentina             Other   536
2      Armenia           Armenia     2
3    Australia   Australia Other   245
4    Australia   New South Wales    85
..         ...               ...   ...
420    Uruguay           Juanico    12
421    Uruguay        Montevideo    11
422    Uruguay          Progreso    11
423    Uruguay          San Jose     3
424    Uruguay           Uruguay    24
[425 rows x 3 columns]
</code></pre><p>同时使用多个列排序</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>countries_reviewed<span style=color:#f92672>.</span>sort_values(by<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;country&#39;</span>, <span style=color:#e6db74>&#39;len&#39;</span>])
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>       country          province   len
1    Argentina             Other   536
0    Argentina  Mendoza Province  3264
2      Armenia           Armenia     2
6    Australia          Tasmania    42
4    Australia   New South Wales    85
..         ...               ...   ...
421    Uruguay        Montevideo    11
422    Uruguay          Progreso    11
420    Uruguay           Juanico    12
424    Uruguay           Uruguay    24
419    Uruguay         Canelones    43
[425 rows x 3 columns]
</code></pre><h2 id=数据类型和缺失值>数据类型和缺失值</h2>
<p>获取 price 列的数据类型</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>price<span style=color:#f92672>.</span>dtype
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>dtype('float64')
</code></pre><p>查看 dataframe 中每一列的数据类型</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>dtypes
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>Unnamed: 0                 int64
country                   object
description               object
designation               object
points                     int64
price                    float64
province                  object
region_1                  object
region_2                  object
taster_name               object
taster_twitter_handle     object
title                     object
variety                   object
winery                    object
dtype: object
</code></pre><p>使用 <code>astype()</code> 转换数据类型</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>points<span style=color:#f92672>.</span>astype(<span style=color:#e6db74>&#39;float64&#39;</span>)
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>0         87.0
1         87.0
2         87.0
3         87.0
4         87.0
          ...
129966    90.0
129967    90.0
129968    90.0
129969    90.0
129970    90.0
Name: points, Length: 129971, dtype: float64
</code></pre><p>缺少值的条目被赋予值 NaN，缩写为 &ldquo;Not a Number&rdquo;</p>
<p>查看 country 为 NaN 的行</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews[pd<span style=color:#f92672>.</span>isnull(reviews<span style=color:#f92672>.</span>country)]
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>        Unnamed: 0 country  ...             variety                           winery
913            913     NaN  ...             Chinuri               Gotsa Family Wines
3131          3131     NaN  ...           Red Blend                Barton &amp; Guestier
4243          4243     NaN  ...            Ojaleshi  Kakhetia Traditional Winemaking
9509          9509     NaN  ...         White Blend                         Tsililis
9750          9750     NaN  ...          Chardonnay                         Ross-idi
            ...     ...  ...                 ...                              ...
124176      124176     NaN  ...           Red Blend                Les Frères Dutruy
129407      129407     NaN  ...  Cabernet Sauvignon                      El Capricho
129408      129408     NaN  ...         Tempranillo                      El Capricho
129590      129590     NaN  ...           Red Blend                        Büyülübağ
129900      129900     NaN  ...              Merlot                           Psagot
[63 rows x 14 columns]
</code></pre><p>使用 <code>fillna()</code> 填充缺失的行</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>region_2<span style=color:#f92672>.</span>fillna(<span style=color:#e6db74>&#34;Unknown)</span>
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>0                   Unknown
1                   Unknown
2         Willamette Valley
3                   Unknown
4         Willamette Valley
                ...
129966              Unknown
129967         Oregon Other
129968              Unknown
129969              Unknown
129970              Unknown
Name: region_2, Length: 129971, dtype: object
</code></pre><p>使用 <code>replace(old_val, new_val)</code> 方法替换非空值</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>taster_twitter_handle<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;@kerinokeefe&#34;</span>, <span style=color:#e6db74>&#34;@kerino&#34;</span>)
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>0             @kerino
1          @vossroger
2          @paulgwine 
3                 NaN
4          @paulgwine 
             ...
129966            NaN
129967     @paulgwine 
129968     @vossroger
129969     @vossroger
129970     @vossroger
Name: taster_twitter_handle, Length: 129971, dtype: object
</code></pre><h2 id=重命名和合并>重命名和合并</h2>
<p>重命名一列</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>rename(columns<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;points&#39;</span>: <span style=color:#e6db74>&#39;score&#39;</span>})
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>        Unnamed: 0  ...                                    winery
0                0  ...                                   Nicosia
1                1  ...                       Quinta dos Avidagos
2                2  ...                                 Rainstorm
3                3  ...                                St. Julian
4                4  ...                              Sweet Cheeks
            ...  ...                                       ...
129966      129966  ...  Dr. H. Thanisch (Erben Müller-Burggraef)
129967      129967  ...                                  Citation
129968      129968  ...                           Domaine Gresser
129969      129969  ...                      Domaine Marcel Deiss
129970      129970  ...                          Domaine Schoffit
[129971 rows x 14 columns]
</code></pre><p>重命名可以选择 index 或者 colum 参数</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>rename(index<span style=color:#f92672>=</span>{<span style=color:#ae81ff>0</span>: <span style=color:#e6db74>&#39;firstEntry&#39;</span>, <span style=color:#ae81ff>1</span>: <span style=color:#e6db74>&#39;secondEntry&#39;</span>})
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>             Unnamed: 0  ...                                    winery
firstEntry            0  ...                                   Nicosia
secondEntry           1  ...                       Quinta dos Avidagos
2                     2  ...                                 Rainstorm
3                     3  ...                                St. Julian
4                     4  ...                              Sweet Cheeks
                 ...  ...                                       ...
129966           129966  ...  Dr. H. Thanisch (Erben Müller-Burggraef)
129967           129967  ...                                  Citation
129968           129968  ...                           Domaine Gresser
129969           129969  ...                      Domaine Marcel Deiss
129970           129970  ...                          Domaine Schoffit
[129971 rows x 14 columns]
</code></pre><p>因为很少重命名索引值，通常情况下 <code>set_index()</code> 更好用</p>
<p>给行索引和列索引添加名称属性</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>reviews<span style=color:#f92672>.</span>rename_axis(<span style=color:#e6db74>&#34;wines&#34;</span>, axis<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;rows&#39;</span>)<span style=color:#f92672>.</span>rename_axis(<span style=color:#e6db74>&#34;fields&#34;</span>, axis<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;columns&#39;</span>)
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>fields  Unnamed: 0  ...                                    winery
wines               ...
0                0  ...                                   Nicosia
1                1  ...                       Quinta dos Avidagos
2                2  ...                                 Rainstorm
3                3  ...                                St. Julian
4                4  ...                              Sweet Cheeks
            ...  ...                                       ...
129966      129966  ...  Dr. H. Thanisch (Erben Müller-Burggraef)
129967      129967  ...                                  Citation
129968      129968  ...                           Domaine Gresser
129969      129969  ...                      Domaine Marcel Deiss
129970      129970  ...                          Domaine Schoffit
[129971 rows x 14 columns]
</code></pre><p>组合有三个核心方法<code>concat()</code>, <code>join()</code> 和 <code>merge()</code></p>
<p>concat(): 给定一个元素列表，此函数将沿着一个 axis 将这些元素混合在一起</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>canadian_youtube
british_youtube
pd<span style=color:#f92672>.</span>concat([canadian_youtube, british_youtube])
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>          video_id  ...                                        description
0      n1WpP7iowLc  ...  Eminem's new track Walk on Water ft. Beyoncé i...
1      0dBIkQ4Mz1M  ...  STill got a lot of packages. Probably will las...
2      5qpjK5DgCt4  ...  WATCH MY PREVIOUS VIDEO ▶ \n\nSUBSCRIBE ► http...
3      d380meD0W0M  ...  I know it's been a while since we did this sho...
4      2Vv-BfVoq4g  ...  🎧: https://ad.gt/yt-perfect\n💰: https://atlant...
            ...  ...                                                ...
40876  sGolxsMSGfQ  ...  🚨 NEW MERCH! http://amzn.to/annoyingorange 🚨➤ ...
40877  8HNuRNi8t70  ...  ► Retrouvez vos programmes préférés : https://...
40878  GWlKEM3m2EE  ...  Find out more about Kingdom Hearts 3: https://...
40879  lbMKLzQ4cNQ  ...  Peter Navarro isn’t talking so tough now. Ana ...
40880  POTgw38-m58  ...  藝人：李妍瑾、玉兔、班傑、LaLa、小優、少少專家：陳筱屏(律師)、Wendy(心理師)、羅...
[40881 rows x 16 columns]

          video_id  ...                                        description
0      Jw1Y-zhQURU  ...  Click here to continue the story and make your...
1      3s1rvMFUweQ  ...  Musical guest Taylor Swift performs …Ready for...
2      n1WpP7iowLc  ...  Eminem's new track Walk on Water ft. Beyoncé i...
3      PUTEiSjKwJU  ...  Salford drew 4-4 against the Class of 92 and F...
4      rHwDegptbI4  ...  Dashcam captures truck's near miss with child ...
            ...  ...                                                ...
38911  l884wKofd54  ...  NEW SONG - MOVE TO MIAMI feat. Pitbull (Click ...
38912  IP8k2xkhOdI  ...  THE OFFICIAL UP WITH IT MUSIC VIDEO!Get my new...
38913  Il-an3K9pjg  ...  Get 2002 by Anne-Marie HERE ▶ http://ad.gt/200...
38914  -DRsfNObKIQ  ...  Eleni Foureira represented Cyprus at the first...
38915  4YFo4bdMO8Q  ...  Debut album 'Light of Mine' out now: http://ky...
[38916 rows x 16 columns]

          video_id  ...                                        description
0      n1WpP7iowLc  ...  Eminem's new track Walk on Water ft. Beyoncé i...
1      0dBIkQ4Mz1M  ...  STill got a lot of packages. Probably will las...
2      5qpjK5DgCt4  ...  WATCH MY PREVIOUS VIDEO ▶ \n\nSUBSCRIBE ► http...
3      d380meD0W0M  ...  I know it's been a while since we did this sho...
4      2Vv-BfVoq4g  ...  🎧: https://ad.gt/yt-perfect\n💰: https://atlant...
            ...  ...                                                ...
38911  l884wKofd54  ...  NEW SONG - MOVE TO MIAMI feat. Pitbull (Click ...
38912  IP8k2xkhOdI  ...  THE OFFICIAL UP WITH IT MUSIC VIDEO!Get my new...
38913  Il-an3K9pjg  ...  Get 2002 by Anne-Marie HERE ▶ http://ad.gt/200...
38914  -DRsfNObKIQ  ...  Eleni Foureira represented Cyprus at the first...
38915  4YFo4bdMO8Q  ...  Debut album 'Light of Mine' out now: http://ky...
[79797 rows x 16 columns]
</code></pre><p>join(): 可以组合具有共同索引的不同 dataframe 对象</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>left <span style=color:#f92672>=</span> canadian_youtube<span style=color:#f92672>.</span>set_index([<span style=color:#e6db74>&#39;title&#39;</span>, <span style=color:#e6db74>&#39;trending_date&#39;</span>])
right <span style=color:#f92672>=</span> british_youtube<span style=color:#f92672>.</span>set_index([<span style=color:#e6db74>&#39;title&#39;</span>, <span style=color:#e6db74>&#39;trending_date&#39;</span>])

left<span style=color:#f92672>.</span>join(right, lsuffix<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;_CAN&#39;</span>, rsuffix<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;_UK&#39;</span>)
</code></pre></div><p>Output:</p>
<pre tabindex=0><code>                                                                 video_id_CAN  ... description_UK
title                                              trending_date               ...
!! THIS VIDEO IS NOTHING BUT PAIN !! | Getting ... 18.04.01       PNn8sECd7io  ...            NaN
#1 Fortnite World Rank - 2,323 Solo Wins!          18.09.03       DvPW66IFhMI  ...            NaN
#1 Fortnite World Rank - 2,330 Solo Wins!          18.10.03       EXEaMjFeiEk  ...            NaN
#1 MOST ANTICIPATED VIDEO (Timber Frame House R... 17.20.12       bYvQmusLaxw  ...            NaN
                                                   17.21.12       bYvQmusLaxw  ...            NaN
                                                                       ...  ...            ...
😲She Is So Nervous But BLOWS The ROOF After Tak... 18.02.05       WttN1Z0XF4k  ...            NaN
                                                   18.29.04       WttN1Z0XF4k  ...            NaN
                                                   18.30.04       WttN1Z0XF4k  ...            NaN
🚨 BREAKING NEWS 🔴 Raja Live all Slot Channels W... 18.07.05       Wt9Gkpmbt44  ...            NaN
🚨Active Shooter at YouTube Headquarters - LIVE ... 18.04.04       Az72jrKbANA  ...            NaN
[40900 rows x 28 columns]
</code></pre><h2 id=其他>其他</h2>
<p>显示所有列</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python>pd<span style=color:#f92672>.</span>set_option(<span style=color:#e6db74>&#34;display.max_columns&#34;</span>, <span style=color:#66d9ef>None</span>)
</code></pre></div>
</section>
<footer class=article-footer>
<section class=article-tags>
<a href=/tags/data-science/>data science</a>
</section>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
</article>
<aside class=related-contents--wrapper>
<h2 class=section-title>Related contents</h2>
<div class=related-contents>
<div class="flex article-list--tile">
<article class=has-image>
<a href=/p/data-mining/>
<div class=article-image>
<img src=/p/data-mining/cover.3467d861335eb3a58067278fd83ca2ce_hu47a4dc7099a691ba7c72bfa70ad196c5_548249_250x150_fill_box_center_3.png width=250 height=150 loading=lazy data-key data-hash="md5-NGfYYTNes6WAZyeP2Dyizg==">
</div>
<div class=article-details>
<h2 class=article-title>Data Mining</h2>
</div>
</a>
</article>
<article>
<a href=/p/python-%E7%8E%AF%E5%A2%83%E7%AE%A1%E7%90%86/>
<div class=article-details>
<h2 class=article-title>Python 环境管理</h2>
</div>
</a>
</article>
<article>
<a href=/p/effective-python/>
<div class=article-details>
<h2 class=article-title>Effective Python</h2>
</div>
</a>
</article>
<article>
<a href=/p/python-encode/>
<div class=article-details>
<h2 class=article-title>Python Encode</h2>
</div>
</a>
</article>
</div>
</div>
</aside>
<div id=gitalk-container></div>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css>
<script src=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/blueimp-md5@2.18.0/js/md5.min.js></script>
<script>const gitalk=new Gitalk({clientID:"60fcbf378ba98da93c38",clientSecret:"97006a937aa9fd569bd7f7c6f1dfa69e39c45a2a",repo:"saltfishpr.github.io",owner:"saltfishpr",admin:["saltfishpr"],distractionFreeMode:!1,id:md5(location.pathname)});(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("gitalk-container").innerHTML="Gitalk comments not available by default when the website is previewed locally.";return}gitalk.render("gitalk-container")})()</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2020 -
2021 咸鱼硕的博客
</section>
<section class=powerby>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.5.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">Table of contents</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#分组和排序>分组和排序</a></li>
<li><a href=#数据类型和缺失值>数据类型和缺失值</a></li>
<li><a href=#重命名和合并>重命名和合并</a></li>
<li><a href=#其他>其他</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>