<!doctype html><html lang=en-us>
<head><meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Go 语言学习"><title>Ultimate Go</title>
<link rel=canonical href=https://saltfishpr.github.io/p/ultimate-go/>
<link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="Ultimate Go">
<meta property="og:description" content="Go 语言学习">
<meta property="og:url" content="https://saltfishpr.github.io/p/ultimate-go/">
<meta property="og:site_name" content="咸鱼硕的博客">
<meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:published_time" content="2020-09-22T00:00:00+00:00"><meta property="article:modified_time" content="2020-09-22T00:00:00+00:00"><meta property="og:image" content="https://saltfishpr.github.io/p/ultimate-go/cover.png">
<meta name=twitter:site content="@saltfishpr">
<meta name=twitter:creator content="@saltfishpr"><meta name=twitter:title content="Ultimate Go">
<meta name=twitter:description content="Go 语言学习"><meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://saltfishpr.github.io/p/ultimate-go/cover.png">
</head>
<body class="article-page has-toc">
<script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script>
<div class="container main-container flex
extended">
<div id=article-toolbar>
<a href=/ class=back-home><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="15 6 9 12 15 18"/></svg>
<span>Back</span>
</a>
</div>
<main class="main full-width">
<article class="has-image main-article">
<header class=article-header>
<div class=article-image>
<a href=/p/ultimate-go/>
<img src=/p/ultimate-go/cover_hueb579e5d699d1c5351ecf353cfba2e0e_76054_800x0_resize_box_3.png srcset="/p/ultimate-go/cover_hueb579e5d699d1c5351ecf353cfba2e0e_76054_800x0_resize_box_3.png 800w, /p/ultimate-go/cover_hueb579e5d699d1c5351ecf353cfba2e0e_76054_1600x0_resize_box_3.png 1600w" width=800 height=319 loading=lazy alt="Featured image of post Ultimate Go">
</a>
</div>
<div class=article-details>
<header class=article-category>
<a href=/categories/golang/>
golang
</a>
</header>
<h2 class=article-title>
<a href=/p/ultimate-go/>Ultimate Go</a>
</h2>
<h3 class=article-subtitle>
Go 语言学习
</h3>
<footer class=article-time>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Sep 22, 2020</time>
</div>
<div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>
7 minute read
</time>
</div>
</footer>
</div>
</header>
<section class=article-content>
<h1 id=ultimate-go>Ultimate Go</h1>
<p>Go 语言基础学习</p>
<h2 id=变量>变量</h2>
<h4 id=结构体的声明与使用>结构体的声明与使用</h4>
<p>使用 <code>type &lt;struct_name> struct {}</code> 声明结构体</p>
<p>input:</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>type</span> <span class=nx>student</span> <span class=kd>struct</span> <span class=p>{</span>
	<span class=nx>name</span>  <span class=kt>string</span>
	<span class=nx>grade</span> <span class=kt>int</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=kd>var</span> <span class=nx>s</span> <span class=nx>student</span> <span class=p>=</span> <span class=nx>student</span><span class=p>{</span><span class=nx>name</span><span class=p>:</span> <span class=s>&#34;SaltFish&#34;</span><span class=p>,</span> <span class=nx>grade</span><span class=p>:</span> <span class=mi>4</span><span class=p>}</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%v\n&#34;</span><span class=p>,</span> <span class=nx>s</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><p>output:</p>
<pre tabindex=0><code>{SaltFish 4}
</code></pre><ul>
<li><code>%T</code> 值类型的 Go 语法表示 <code>main.student</code></li>
<li><code>%v</code> 值 <code>{SaltFish 4}</code></li>
<li><code>%+v</code> 值，添加字段名 <code>{name:SaltFish grade:4}</code></li>
<li><code>%#v</code> 值，Go 语法表示 <code>main.student{name:"SaltFish", grade:4}</code></li>
</ul>
<h2 id=go-语言核心编程笔记>go 语言核心编程笔记</h2>
<hr>
<p><code>&^</code> 运算符</p>
<p><code>a &^ b</code></p>
<ol>
<li>如果右侧是 0，则左侧数保持不变</li>
<li>如果右侧是 1，则左侧数一定清零</li>
</ol>
<hr>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>const</span> <span class=p>(</span>
	<span class=nx>a</span> <span class=p>=</span> <span class=mi>1</span>     <span class=c1>// iota = 0, unused
</span><span class=c1></span>	<span class=nx>b</span> <span class=p>=</span> <span class=kc>iota</span>  <span class=c1>// iota = 1
</span><span class=c1></span>	<span class=nx>c</span> <span class=p>=</span> <span class=mi>3</span>     <span class=c1>// iota = 2, unused
</span><span class=c1></span>	<span class=nx>d</span>         <span class=c1>// iota = 3
</span><span class=c1></span><span class=p>)</span>

<span class=kd>const</span> <span class=p>(</span>
	<span class=nx>e</span> <span class=p>=</span> <span class=kc>iota</span>  <span class=c1>// iota = 0, 每一个const，iota从0开始
</span><span class=c1></span><span class=p>)</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%d %d %d %d %d\n&#34;</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>,</span> <span class=nx>c</span><span class=p>,</span> <span class=nx>d</span><span class=p>,</span> <span class=nx>e</span><span class=p>)</span>
<span class=p>}</span>

<span class=mi>0</span> <span class=mi>1</span> <span class=mi>3</span> <span class=mi>3</span> <span class=mi>0</span>
</code></pre></div><hr>
<p>int 是大小至少为 32 位的有符号整数类型。但是，它是一个不同的类型，而不是 int32 的别名。
<code>type int int</code></p>
<p>byte 是 uint8 的别名，在所有方面都与 uint8 等效。按照惯例，它用于区分字节值和 8 位无符号整数值。
<code>type byte = uint8</code></p>
<p>rune 是 int32 的别名，在所有方面都与 int32 等效。按惯例，它用于区分字符值和整数值。
<code>type rune = int32</code></p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=c1>// int8 is the set of all signed 8-bit integers.
</span><span class=c1>// Range: -128 through 127.
</span><span class=c1></span><span class=kd>type</span> <span class=kt>int8</span> <span class=kt>int8</span>

<span class=c1>// int16 is the set of all signed 16-bit integers.
</span><span class=c1>// Range: -32768 through 32767.
</span><span class=c1></span><span class=kd>type</span> <span class=kt>int16</span> <span class=kt>int16</span>

<span class=c1>// int32 is the set of all signed 32-bit integers.
</span><span class=c1>// Range: -2147483648 through 2147483647.
</span><span class=c1></span><span class=kd>type</span> <span class=kt>int32</span> <span class=kt>int32</span>

<span class=c1>// int64 is the set of all signed 64-bit integers.
</span><span class=c1>// Range: -9223372036854775808 through 9223372036854775807.
</span><span class=c1></span><span class=kd>type</span> <span class=kt>int64</span> <span class=kt>int64</span>

<span class=c1>// float32 is the set of all IEEE-754 32-bit floating-point numbers.
</span><span class=c1></span><span class=kd>type</span> <span class=kt>float32</span> <span class=kt>float32</span>

<span class=c1>// float64 is the set of all IEEE-754 64-bit floating-point numbers.
</span><span class=c1></span><span class=kd>type</span> <span class=kt>float64</span> <span class=kt>float64</span>

<span class=c1>// complex64 is the set of all complex numbers with float32 real and
</span><span class=c1>// imaginary parts.
</span><span class=c1></span><span class=kd>type</span> <span class=kt>complex64</span> <span class=kt>complex64</span>

<span class=c1>// complex128 is the set of all complex numbers with float64 real and
</span><span class=c1>// imaginary parts.
</span><span class=c1></span><span class=kd>type</span> <span class=kt>complex128</span> <span class=kt>complex128</span>
</code></pre></div><hr>
<p>float 的比较</p>
<p>计算机很难进行浮点数的精确表示和存储，因此两个浮点数之间不应该使用==或!=进行比较操作，高精度科学计算应该使用 math 标准库。</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=kd>var</span> <span class=nx>v</span> <span class=p>=</span> <span class=nb>complex</span><span class=p>(</span><span class=mf>2.1</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span>  <span class=c1>// 构造一个复数
</span><span class=c1></span>	<span class=nx>a</span> <span class=o>:=</span> <span class=nb>real</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span>  <span class=c1>// 2.1, 实部
</span><span class=c1></span>	<span class=nx>b</span> <span class=o>:=</span> <span class=nb>imag</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span>  <span class=c1>// 3  , 虚部
</span><span class=c1></span>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%v + %vi\n&#34;</span><span class=p>,</span> <span class=nx>a</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><hr>
<p>字符串是常量，不能修改某个字节的值</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>var</span> <span class=nx>s</span> <span class=p>=</span> <span class=s>&#34;SaltFish&#34;</span>
<span class=nx>s</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=p>=</span> <span class=sc>&#39;I&#39;</span> <span class=c1>// cannot assign to s[2] (value of type byte)
</span></code></pre></div><p>string 是 8 位字节的所有字符串的集合，通常但不一定表示 UTF-8 编码的文本。字符串可以为空，但不能为 nil。字符串类型的值是不可变的。
<code>type string string</code></p>
<p>字符串底层是一个二元的数据结构，一个是指针(指向字节数组的起点)，另一个是长度</p>
<p>对字符串切片返回 string 而不是 slice，并且字串指向相同的底层字符数组</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>var</span> <span class=nx>s</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;SaltFish&#34;</span>
<span class=nx>a</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>4</span><span class=p>]</span> <span class=c1>// var a string
</span><span class=c1></span><span class=nx>a</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=p>=</span> <span class=s>&#34;I&#34;</span>  <span class=c1>// cannot assign to a[2] (value of type byte)
</span></code></pre></div><p>字符串转换为 字节数组/Unicode 字符数组</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>var</span> <span class=nx>s</span> <span class=kt>string</span> <span class=p>=</span> <span class=s>&#34;SaltFish, 你好&#34;</span>
<span class=nx>a</span> <span class=o>:=</span> <span class=p>[]</span><span class=nb>byte</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span> <span class=c1>// [83 97 108 116 70 105 115 104 44 32 228 189 160 229 165 189]
</span><span class=c1></span><span class=nx>b</span> <span class=o>:=</span> <span class=p>[]</span><span class=nb>rune</span><span class=p>(</span><span class=nx>s</span><span class=p>)</span> <span class=c1>// [83 97 108 116 70 105 115 104 44 32 20320 22909]
</span></code></pre></div><hr>
<p>允许函数返回局部变量的地址，该局部变量的空间被分配在堆上(&ldquo;栈逃逸"机制)</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>sum</span><span class=p>(</span><span class=nx>a</span><span class=p>,</span> <span class=nx>b</span> <span class=kt>int</span><span class=p>)</span> <span class=o>*</span><span class=kt>int</span> <span class=p>{</span>
	<span class=nx>res</span> <span class=o>:=</span> <span class=nx>a</span> <span class=o>+</span> <span class=nx>b</span>
	<span class=k>return</span> <span class=o>&amp;</span><span class=nx>res</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>x</span><span class=p>,</span> <span class=nx>y</span> <span class=o>:=</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span>
	<span class=nx>z</span> <span class=o>:=</span> <span class=nf>sum</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span> <span class=nx>y</span><span class=p>)</span> <span class=c1>// 4
</span><span class=c1></span>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>*</span><span class=nx>z</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><hr>
<p>数组在声明时需要指定长度，初始化时可以不指定长度，由</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>var</span> <span class=nx>a</span> <span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=kt>int</span>              <span class=c1>// [0, 0], 声明时需要指定长度
</span><span class=c1></span><span class=nx>b</span> <span class=o>:=</span> <span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>}</span>         <span class=c1>// [1, 2, 0], 初始化时指定长度
</span><span class=c1></span><span class=nx>c</span> <span class=o>:=</span> <span class=p>[</span><span class=o>...</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>}</span>    <span class=c1>// [4, 5, 6], 初始化时不指定长度，由元素个数决定
</span><span class=c1></span><span class=nx>d</span> <span class=o>:=</span> <span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>:</span> <span class=mi>3</span><span class=p>}</span>   <span class=c1>// [0, 1, 3], 初始化时指定长度，使用索引值赋值
</span><span class=c1></span><span class=nx>e</span> <span class=o>:=</span> <span class=p>[</span><span class=o>...</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>1</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>:</span> <span class=mi>3</span><span class=p>}</span> <span class=c1>// [0, 1, 0, 3], 初始化时不指定长度，由最后一个索引值决定
</span></code></pre></div><ol>
<li>数组创建后长度固定</li>
<li>数组是值类型的，赋值或作为函数参数都是值拷贝</li>
<li>数组长度是数组类型的组成部分, <code>[1O]int</code> 和 <code>[20]int</code> 表示不同的类型</li>
<li>可以根据数组创建切片</li>
</ol>
<hr>
<p>切片是引用类型，其数据结构中有指向数组的指针</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>type</span> <span class=nx>slice</span> <span class=kd>struct</span> <span class=p>{</span>
	<span class=nx>array</span> <span class=nx>unsafe</span><span class=p>.</span><span class=nx>Pointer</span> <span class=c1>// 指向底层数组的指针
</span><span class=c1></span>	<span class=nx>len</span>   <span class=kt>int</span>            <span class=c1>// 切片长度
</span><span class=c1></span>	<span class=nx>cap</span>   <span class=kt>int</span>            <span class=c1>// 切片底层数组容量
</span><span class=c1></span><span class=p>}</span>
</code></pre></div><p>切片复制时的限制</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go>	<span class=kd>var</span> <span class=nx>a</span> <span class=p>[</span><span class=mi>7</span><span class=p>]</span><span class=kt>int</span> <span class=p>=</span> <span class=p>[</span><span class=mi>7</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>5</span><span class=p>,</span> <span class=mi>6</span><span class=p>}</span>
	<span class=nx>b</span> <span class=o>:=</span> <span class=nx>a</span><span class=p>[</span><span class=mi>0</span><span class=p>:</span><span class=mi>3</span><span class=p>]</span> <span class=c1>// [0 1 2]
</span><span class=c1></span>	<span class=nx>c</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>([]</span><span class=kt>int</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
	<span class=nb>copy</span><span class=p>(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>b</span><span class=p>)</span> <span class=c1>// [0 1], 两个切片中长度最小的限制复制长度
</span></code></pre></div><hr>
<p>创建一个 map</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>m1</span> <span class=o>:=</span> <span class=kd>map</span><span class=p>[</span><span class=kt>string</span><span class=p>]</span><span class=kt>int</span><span class=p>{</span><span class=s>&#34;a&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s>&#34;b&#34;</span><span class=p>:</span> <span class=mi>2</span><span class=p>}</span> <span class=c1>//map[a:1 b:2]
</span><span class=c1></span><span class=nx>m2</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>int</span><span class=p>]</span><span class=kt>string</span><span class=p>)</span>           <span class=c1>//map[]
</span><span class=c1></span>
<span class=kd>var</span> <span class=nx>m3</span> <span class=kd>map</span><span class=p>[</span><span class=kt>int</span><span class=p>]</span><span class=kt>int</span> <span class=c1>// 定义一个map，但指针指向nil，需要初始化，正确做法 var m3 map[int]int = make(map[int]int)
</span><span class=c1></span><span class=nx>m3</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>=</span> <span class=mi>10</span>         <span class=c1>// assignment to entry in nil map
</span></code></pre></div><p>map 是无序的</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>m1</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>int</span><span class=p>]</span><span class=kt>string</span><span class=p>)</span>
	<span class=nx>m1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>=</span> <span class=s>&#34;tom&#34;</span>
	<span class=nx>m1</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>=</span> <span class=s>&#34;jerry&#34;</span> <span class=c1>// 覆盖
</span><span class=c1></span>	<span class=nx>m1</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=p>=</span> <span class=s>&#34;piony&#34;</span>
	<span class=nx>m1</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span> <span class=p>=</span> <span class=s>&#34;july&#34;</span>
	<span class=nb>delete</span><span class=p>(</span><span class=nx>m1</span><span class=p>,</span> <span class=mi>3</span><span class=p>)</span> <span class=c1>// 删除键3元素
</span><span class=c1></span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>m1</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>   <span class=c1>// jerry
</span><span class=c1></span>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>m1</span><span class=p>))</span> <span class=c1>// 2, 键值对数量
</span><span class=c1></span>	<span class=k>for</span> <span class=nx>k</span><span class=p>,</span> <span class=nx>v</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>m1</span> <span class=p>{</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=s>&#34;key=&#34;</span><span class=p>,</span> <span class=nx>k</span><span class=p>,</span> <span class=s>&#34; value=&#34;</span><span class=p>,</span> <span class=nx>v</span><span class=p>)</span> <span class=c1>// 输出顺序可能改变
</span><span class=c1></span>	<span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>无法在 map 中更改元素的值， 若想修改，只能整体赋值</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>m</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>map</span><span class=p>[</span><span class=kt>int</span><span class=p>]</span><span class=nx>student</span><span class=p>)</span>
<span class=nx>s1</span> <span class=o>:=</span> <span class=nx>student</span><span class=p>{</span><span class=nx>name</span><span class=p>:</span> <span class=s>&#34;saltfish&#34;</span><span class=p>,</span> <span class=nx>age</span><span class=p>:</span> <span class=mi>18</span><span class=p>}</span>
<span class=nx>m</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>=</span> <span class=nx>s1</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%+v\n&#34;</span><span class=p>,</span> <span class=nx>m</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=c1>//{name:saltfish age:18}
</span><span class=c1>//m[1].age = 22           // err: cannot assign to struct field m[1].age in map
</span><span class=c1></span><span class=nx>m</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=p>=</span> <span class=nx>student</span><span class=p>{</span><span class=nx>name</span><span class=p>:</span> <span class=s>&#34;saltfish&#34;</span><span class=p>,</span> <span class=nx>age</span><span class=p>:</span> <span class=mi>22</span><span class=p>}</span>
<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%+v\n&#34;</span><span class=p>,</span> <span class=nx>m</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span> <span class=c1>//{name:saltfish age:22}
</span></code></pre></div><hr>
<ol>
<li>struct 中的类型可以为任意类型</li>
<li>struct 的存储空间是连续的，字段按照声明时的顺序存放，但字段之间有<strong>对齐</strong>要求</li>
</ol>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=nx>a</span> <span class=o>:=</span> <span class=nx>person</span><span class=p>{</span><span class=s>&#34;saltfish&#34;</span><span class=p>,</span> <span class=mi>18</span><span class=p>}</span>             <span class=c1>// 不推荐使用这种初始化方式，一旦struct定义发生变化，这个语句就会报错
</span><span class=c1></span><span class=nx>p</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>person</span><span class=p>{</span><span class=nx>name</span><span class=p>:</span> <span class=s>&#34;saltfish&#34;</span><span class=p>,</span> <span class=nx>age</span><span class=p>:</span> <span class=mi>18</span><span class=p>}</span> <span class=c1>// 其它字段会被初始化为类型的零值
</span><span class=c1></span><span class=nx>s</span> <span class=o>:=</span> <span class=nx>student</span><span class=p>{</span><span class=nx>person</span><span class=p>:</span> <span class=nx>p</span><span class=p>,</span> <span class=nx>grade</span><span class=p>:</span> <span class=mi>4</span><span class=p>}</span>
</code></pre></div><hr>
<ol>
<li>goto 语句只能在函数内部跳转</li>
<li>goto 语句不能跳过内部变量声明语句</li>
<li>goto 语句只能跳到同级作用域或上层作用域内，不能跳到内部作用域内</li>
</ol>
<p>break 与标签使用可以跳出标签所标识的 for, switch, select 语句的执行</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
<span class=nx>L1</span><span class=p>:</span>
	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
		<span class=k>for</span> <span class=nx>j</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=p>;</span> <span class=nx>j</span><span class=o>++</span> <span class=p>{</span>
			<span class=k>if</span> <span class=nx>i</span> <span class=o>&gt;=</span> <span class=mi>5</span> <span class=p>{</span>
				<span class=k>break</span> <span class=nx>L1</span> <span class=c1>// 跳出L1标签所在的for, break和标签要在同一函数内
</span><span class=c1></span>			<span class=p>}</span>
			<span class=k>if</span> <span class=nx>j</span> <span class=p>&gt;</span> <span class=mi>10</span> <span class=p>{</span>
				<span class=k>break</span>
			<span class=p>}</span>
		<span class=p>}</span>
	<span class=p>}</span>
<span class=p>}</span>
</code></pre></div><hr>
<p>go 函数实参到形参传递永远是值拷贝，传递指针时传递的是指针的副本，指向同一地址，本质上也是值拷贝</p>
<ol>
<li>defer 调用以先进后出的顺序在函数返回前被执行</li>
<li>defer 参数的实参在注册时通过值拷贝传递进去</li>
<li>主动调用 os.Exit(int) 退出进程时，defer 将不再被执行，即使已经注册</li>
</ol>
<hr>
<p>闭包 = 函数 + 引用环境</p>
<ol>
<li>闭包对闭包外的环境引入是直接引用</li>
<li>返回的闭包有自己的独立空间，如果闭包引用修改了外部变量，则每次调用都会影响外部变量</li>
</ol>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>fa</span><span class=p>(</span><span class=nx>a</span> <span class=kt>int</span><span class=p>)</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
	<span class=c1>// 传入的参数 a 对于闭包内是外部变量
</span><span class=c1></span>	<span class=k>return</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=kt>int</span><span class=p>)</span> <span class=kt>int</span> <span class=p>{</span>
		<span class=nb>println</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>a</span><span class=p>,</span> <span class=nx>a</span><span class=p>)</span>
		<span class=nx>a</span> <span class=p>=</span> <span class=nx>a</span> <span class=o>+</span> <span class=nx>i</span>
		<span class=k>return</span> <span class=nx>a</span>
	<span class=p>}</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>f</span> <span class=o>:=</span> <span class=nf>fa</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
	<span class=nx>g</span> <span class=o>:=</span> <span class=nf>fa</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>

	<span class=nb>println</span><span class=p>(</span><span class=nf>f</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span> <span class=c1>// 形参地址：0xc000012018，形参值：1，返回值：2
</span><span class=c1></span>	<span class=nb>println</span><span class=p>(</span><span class=nf>f</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span> <span class=c1>// 形参地址：0xc000012018，形参值：2，返回值：3
</span><span class=c1></span>
	<span class=nb>println</span><span class=p>(</span><span class=nf>g</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span> <span class=c1>// 形参地址：0xc000012030，形参值：1，返回值：2
</span><span class=c1></span>	<span class=nb>println</span><span class=p>(</span><span class=nf>g</span><span class=p>(</span><span class=mi>1</span><span class=p>))</span> <span class=c1>// 形参地址：0xc000012030，形参值：2，返回值：3
</span><span class=c1></span><span class=p>}</span>
</code></pre></div><p>对象是附有行为的数据，而闭包是附有数据的行为</p>
<hr>
<p>函数并不能捕获内部新启动的 goroutine 所抛出的 panic</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>func</span> <span class=nf>do</span><span class=p>()</span> <span class=p>{</span>
	<span class=c1>// 这里的recover无法捕获下面goroutine抛出的panic
</span><span class=c1></span>	<span class=k>defer</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
		<span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nb>recover</span><span class=p>();</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
			<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>err</span><span class=p>)</span>
		<span class=p>}</span>
	<span class=p>}()</span>

	<span class=k>go</span> <span class=nf>da</span><span class=p>()</span> <span class=c1>// 抛出panic
</span><span class=c1></span>	<span class=k>go</span> <span class=nf>db</span><span class=p>()</span>
	<span class=nx>time</span><span class=p>.</span><span class=nf>Sleep</span><span class=p>(</span><span class=mi>3</span> <span class=o>*</span> <span class=nx>time</span><span class=p>.</span><span class=nx>Second</span><span class=p>)</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>da</span><span class=p>()</span> <span class=p>{</span>
	<span class=nb>panic</span><span class=p>(</span><span class=s>&#34;panic da&#34;</span><span class=p>)</span>
	<span class=c1>// 下面的语句不会被执行
</span><span class=c1></span>	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
	<span class=p>}</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>db</span><span class=p>()</span> <span class=p>{</span>
	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>i</span><span class=p>)</span>
	<span class=p>}</span>
<span class=p>}</span>
</code></pre></div><hr>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kd>var</span> <span class=nx>b</span> <span class=nx>T2</span> <span class=p>=</span> <span class=nx>a</span>
</code></pre></div><p>a 可以赋值给变量 b 必须要满足如下条件中的一个</p>
<ol>
<li>T1 和 T2 的类型相同</li>
<li>T1 和 T2 具有相同的底层类型，并且 T1 和 T2 中至少有一个是未命名类型</li>
<li>T2 是接口类型，T1 是具体类型，且 T1 的方法集是 T2 方法集的超集</li>
<li>T1 和 T2 都是通道类型，他们拥有相同的元素类型，并且 T1 和 T2 中至少有一个是未命名类型</li>
<li>a 是 nil, T2 是 pointer, function, slice, map, channel, interface 类型中的一个</li>
<li>a 是一个字面常量值，可以用来表示类型 T 的值</li>
</ol>
<p>非常量类型的变量 x 可以强制转化并传递给类型 T，需要满足如下任一条件：</p>
<ol>
<li>x 可以直接赋值给 T 类型的变量</li>
<li>x 的类型和 T 具有相同的底层类型</li>
<li>x 的类型和 T 都是未命名的指针类型，并且指针指向的类型具有相同的底层类型</li>
<li>x 的类型和 T 都是整型或都是浮点型</li>
<li>x 的类型和 T 都是复数类型</li>
<li>x 是整数值或[]byte 类型的值，T 是 string 类型</li>
<li>x 是一个字符串，T 是[]byte 或[]rune</li>
</ol>
<hr>
<p>使用无缓冲的通道来实现 goroutines 之间的同步等待</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>main</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>c</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kd>struct</span><span class=p>{})</span> <span class=c1>// 创建同步通道
</span><span class=c1></span>	<span class=nx>ci</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span> <span class=mi>100</span><span class=p>)</span>
	<span class=k>go</span> <span class=kd>func</span><span class=p>(</span><span class=nx>i</span> <span class=kd>chan</span> <span class=kd>struct</span><span class=p>{},</span> <span class=nx>j</span> <span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
		<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
			<span class=nx>ci</span> <span class=o>&lt;-</span> <span class=nx>i</span>
		<span class=p>}</span>
		<span class=nb>close</span><span class=p>(</span><span class=nx>ci</span><span class=p>)</span>
		<span class=nx>c</span> <span class=o>&lt;-</span> <span class=kd>struct</span><span class=p>{}{}</span> <span class=c1>// goroutine 完成
</span><span class=c1></span>	<span class=p>}(</span><span class=nx>c</span><span class=p>,</span> <span class=nx>ci</span><span class=p>)</span>
	<span class=nb>println</span><span class=p>(</span><span class=s>&#34;NumGoroutine= &#34;</span><span class=p>,</span> <span class=nx>runtime</span><span class=p>.</span><span class=nf>NumGoroutine</span><span class=p>())</span>
	<span class=o>&lt;-</span><span class=nx>c</span> <span class=c1>// 阻塞等待
</span><span class=c1></span>	<span class=nb>println</span><span class=p>(</span><span class=s>&#34;NumGoroutine= &#34;</span><span class=p>,</span> <span class=nx>runtime</span><span class=p>.</span><span class=nf>NumGoroutine</span><span class=p>())</span>
	<span class=c1>// 从已经关闭的ci通道中读取
</span><span class=c1></span>	<span class=k>for</span> <span class=nx>v</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>ci</span> <span class=p>{</span>
		<span class=nb>println</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span>
	<span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>WaitGroup 用来等待多个 goroutine 完成</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
	<span class=s>&#34;net/http&#34;</span>
	<span class=s>&#34;sync&#34;</span>
<span class=p>)</span>

<span class=kd>var</span> <span class=nx>wg</span> <span class=nx>sync</span><span class=p>.</span><span class=nx>WaitGroup</span>
<span class=kd>var</span> <span class=nx>urls</span> <span class=p>=</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;http://www.baidu.com/&#34;</span><span class=p>,</span> <span class=s>&#34;http://www.qq.com/&#34;</span><span class=p>,</span> <span class=s>&#34;https://golang.google.cn/&#34;</span><span class=p>,</span> <span class=s>&#34;https://www.google.com&#34;</span><span class=p>}</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>url</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>urls</span> <span class=p>{</span>
		<span class=c1>// 每个URL启动一个goroutine，同时给wg加1
</span><span class=c1></span>		<span class=nx>wg</span><span class=p>.</span><span class=nf>Add</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
		<span class=c1>// 对每个url启动一个goroutine
</span><span class=c1></span>		<span class=k>go</span> <span class=kd>func</span><span class=p>(</span><span class=nx>url</span> <span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
			<span class=c1>// 当goroutine结束后给wg计数减1，wg.Done() 等价于 wg.Add(-1)
</span><span class=c1></span>			<span class=k>defer</span> <span class=nx>wg</span><span class=p>.</span><span class=nf>Done</span><span class=p>()</span>
			<span class=c1>// 发送HTTP get请求并打印返回码
</span><span class=c1></span>			<span class=nx>resp</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>http</span><span class=p>.</span><span class=nf>Get</span><span class=p>(</span><span class=nx>url</span><span class=p>)</span>
			<span class=k>if</span> <span class=nx>err</span> <span class=o>==</span> <span class=kc>nil</span> <span class=p>{</span>
				<span class=nb>println</span><span class=p>(</span><span class=nx>resp</span><span class=p>.</span><span class=nx>Status</span><span class=p>)</span>
			<span class=p>}</span>
		<span class=p>}(</span><span class=nx>url</span><span class=p>)</span>
	<span class=p>}</span>
	<span class=nx>wg</span><span class=p>.</span><span class=nf>Wait</span><span class=p>()</span> <span class=c1>// 等待所有请求结束
</span><span class=c1></span><span class=p>}</span>
</code></pre></div><p>select 用于监听多个通道，只要监听中的信道有一个是可读或者可写的，select 就不会阻塞，若有多个可读或可写，则 select 随机选取一个处理</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>main</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>ch</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
	<span class=k>go</span> <span class=kd>func</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span> <span class=p>{</span>
		<span class=k>for</span> <span class=p>{</span>
			<span class=k>select</span> <span class=p>{</span>
			<span class=k>case</span> <span class=nx>ch</span> <span class=o>&lt;-</span> <span class=mi>0</span><span class=p>:</span>
			<span class=k>case</span> <span class=nx>ch</span> <span class=o>&lt;-</span> <span class=mi>1</span><span class=p>:</span>
			<span class=p>}</span>
		<span class=p>}</span>
	<span class=p>}(</span><span class=nx>ch</span><span class=p>)</span>
	<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
		<span class=nb>println</span><span class=p>(</span><span class=o>&lt;-</span><span class=nx>ch</span><span class=p>)</span>
	<span class=p>}</span>
<span class=p>}</span>
</code></pre></div><p>通知退出机制</p>
<p>读取己经关闭的通道不会引起阻塞，也不会导致 panic ，而是立即返回该通道存储类型的零值。关闭 select 监听的某个通道能使 select 立即感知这种通知，然后进行相应的处理</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=p>(</span>
	<span class=s>&#34;fmt&#34;</span>
	<span class=s>&#34;math/rand&#34;</span>
	<span class=s>&#34;runtime&#34;</span>
<span class=p>)</span>

<span class=kd>func</span> <span class=nf>generateIntA</span><span class=p>(</span><span class=nx>done</span> <span class=kd>chan</span> <span class=kd>struct</span><span class=p>{})</span> <span class=kd>chan</span> <span class=kt>int</span> <span class=p>{</span>
	<span class=nx>ch</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span>
	<span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>LABEL1</span><span class=p>:</span>
		<span class=k>for</span> <span class=p>{</span>
			<span class=k>select</span> <span class=p>{</span>
			<span class=k>case</span> <span class=nx>ch</span> <span class=o>&lt;-</span> <span class=nx>rand</span><span class=p>.</span><span class=nf>Int</span><span class=p>():</span>
			<span class=k>case</span> <span class=o>&lt;-</span><span class=nx>done</span><span class=p>:</span>
				<span class=k>break</span> <span class=nx>LABEL1</span>
			<span class=p>}</span>
		<span class=p>}</span>
		<span class=nb>close</span><span class=p>(</span><span class=nx>ch</span><span class=p>)</span>
	<span class=p>}()</span>
	<span class=k>return</span> <span class=nx>ch</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>done</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kd>struct</span><span class=p>{})</span>
	<span class=nx>ch</span> <span class=o>:=</span> <span class=nf>generateIntA</span><span class=p>(</span><span class=nx>done</span><span class=p>)</span>

	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>&lt;-</span><span class=nx>ch</span><span class=p>)</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>&lt;-</span><span class=nx>ch</span><span class=p>)</span>
	<span class=c1>// 发送通知，告知生产者停止生产
</span><span class=c1></span>	<span class=nb>close</span><span class=p>(</span><span class=nx>done</span><span class=p>)</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>&lt;-</span><span class=nx>ch</span><span class=p>)</span>
	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=o>&lt;-</span><span class=nx>ch</span><span class=p>)</span>

	<span class=nb>println</span><span class=p>(</span><span class=s>&#34;NumGoroutine =&#34;</span><span class=p>,</span> <span class=nx>runtime</span><span class=p>.</span><span class=nf>NumGoroutine</span><span class=p>())</span> <span class=c1>// 生产者已退出，NumGoroutine = 1
</span><span class=c1></span><span class=p>}</span>
</code></pre></div><hr>
<p>管道</p>
<div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>main</span>

<span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>

<span class=kd>func</span> <span class=nf>chain</span><span class=p>(</span><span class=nx>in</span> <span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span> <span class=kd>chan</span> <span class=kt>int</span> <span class=p>{</span>
	<span class=nx>out</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span>
	<span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
		<span class=k>for</span> <span class=nx>v</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>in</span> <span class=p>{</span>
			<span class=nx>out</span> <span class=o>&lt;-</span> <span class=mi>1</span> <span class=o>+</span> <span class=nx>v</span>
		<span class=p>}</span>
		<span class=nb>close</span><span class=p>(</span><span class=nx>out</span><span class=p>)</span>
	<span class=p>}()</span>
	<span class=k>return</span> <span class=nx>out</span>
<span class=p>}</span>

<span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
	<span class=nx>in</span> <span class=o>:=</span> <span class=nb>make</span><span class=p>(</span><span class=kd>chan</span> <span class=kt>int</span><span class=p>)</span>

	<span class=c1>// 初始化传入参数
</span><span class=c1></span>	<span class=k>go</span> <span class=kd>func</span><span class=p>()</span> <span class=p>{</span>
		<span class=k>for</span> <span class=nx>i</span> <span class=o>:=</span> <span class=mi>0</span><span class=p>;</span> <span class=nx>i</span> <span class=p>&lt;</span> <span class=mi>10</span><span class=p>;</span> <span class=nx>i</span><span class=o>++</span> <span class=p>{</span>
			<span class=nx>in</span> <span class=o>&lt;-</span> <span class=nx>i</span>
		<span class=p>}</span>
		<span class=nb>close</span><span class=p>(</span><span class=nx>in</span><span class=p>)</span>
	<span class=p>}()</span>
	<span class=nx>out</span> <span class=o>:=</span> <span class=nf>chain</span><span class=p>(</span><span class=nf>chain</span><span class=p>(</span><span class=nf>chain</span><span class=p>(</span><span class=nx>in</span><span class=p>)))</span>
	<span class=k>for</span> <span class=nx>v</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>out</span> <span class=p>{</span>
		<span class=nx>fmt</span><span class=p>.</span><span class=nf>Println</span><span class=p>(</span><span class=nx>v</span><span class=p>)</span>
	<span class=p>}</span>
<span class=p>}</span>
</code></pre></div>
</section>
<footer class=article-footer>
<section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span>
</section>
</footer>
</article>
<aside class=related-contents--wrapper>
</aside>
<div id=gitalk-container></div>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css>
<script src=https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/blueimp-md5@2.18.0/js/md5.min.js></script>
<script>const gitalk=new Gitalk({clientID:"60fcbf378ba98da93c38",clientSecret:"97006a937aa9fd569bd7f7c6f1dfa69e39c45a2a",repo:"saltfishpr.github.io",owner:"saltfishpr",admin:[""],distractionFreeMode:!1,id:md5(location.pathname)});(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("gitalk-container").innerHTML="Gitalk comments not available by default when the website is previewed locally.";return}gitalk.render("gitalk-container")})()</script>
<footer class=site-footer>
<section class=copyright>
&copy;
2020 -
2021 咸鱼硕的博客
</section>
<section class=powerby>
Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> <br>
Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.5.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a>
</section>
</footer>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous>
</main>
<aside class="sidebar right-sidebar sticky">
<section class="widget archives">
<div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg>
</div>
<h2 class="widget-title section-title">Table of contents</h2>
<div class=widget--toc>
<nav id=TableOfContents>
<ol>
<li><a href=#变量>变量</a>
<ol>
<li>
<ol>
<li><a href=#结构体的声明与使用>结构体的声明与使用</a></li>
</ol>
</li>
</ol>
</li>
<li><a href=#go-语言核心编程笔记>go 语言核心编程笔记</a></li>
</ol>
</nav>
</div>
</section>
</aside>
</div>
<script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script>
<script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script>
</body>
</html>